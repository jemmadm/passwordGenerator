/*
 * This Java source file was generated by the Gradle 'init' task.
 */

import org.junit.Test;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;

import static org.assertj.core.api.Assertions.assertThat;

public class PasswordGeneratorTest {


    //visibility?
    PasswordGenerator passwordGenerator = new PasswordGenerator();


    @Test
    //whitespace
    public void checkAmountOfNumbers() {
        String numbers = passwordGenerator.pickCharactersFromList(5, "1234567890");
        //hasSize?
        assertThat(numbers.length()).isEqualTo(5);
    }

    @Test
    //Do we need both this test and the above
    public void checkAmountOfLetters() {
        String letters = passwordGenerator.pickCharactersFromList(3, "abcdefghijklmnopqrstuvwxyz");
        assertThat(letters.length()).isEqualTo(3);
    }

    @Test
    //ditto
    public void checkAmountOfSpecial() {
        String special = passwordGenerator.pickCharactersFromList(2, "!@Â£$%^&*()?");
        assertThat(special.length()).isEqualTo(2);
    }

    @Test

    public void checkPasswordLength() {

        assertThat(passwordGenerator.createStringOfRandomCharacters().length()).isEqualTo(3);

    }



    @Test
    public void checkSecretPassword() {
        //do we need this variable?
        BCryptPasswordEncoder bCryptPasswordEncoder = new BCryptPasswordEncoder();

        String actualPassword;

        //valid but can we do better?
        while (true) {
            actualPassword = passwordGenerator.createStringOfRandomCharacters();
            System.out.println(actualPassword);

            if (bCryptPasswordEncoder.matches(actualPassword,
                    "$2a$10$N43LdqU9b1ZMuZM2KiBnIeaXiPqxYcTEVoMFabb9ZV2jfG82jupD6")) {
                break;
            }
        }
        //this assert is a bit redundant
         assertThat(bCryptPasswordEncoder.matches(actualPassword,
                "$2a$10$N43LdqU9b1ZMuZM2KiBnIeaXiPqxYcTEVoMFabb9ZV2jfG82jupD6")).isTrue();
    }

    }

